---
title: "Project 2"
author: "Alex Prevatte, Chennade Brown"
date: "10/17/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

```{r}
# Libraries
library(tidyverse)
library(knitr)
```


```{r}
# Read in the data file using a relative path
onlineNews <- read_delim("./OnlineNewsPopularity.csv",
                      delim = ",")
```


```{r}
# Start with using data from a single data_channel_is_* source
variable.names(onlineNews)
# filtered rows for data_channel_is_lifestyle and removed other 5 categories
# removed non-predictive variables
onlineNewsLifestyle <- onlineNews %>% filter(` data_channel_is_lifestyle` == " 1.0") %>% 
  select(- c(` data_channel_is_bus`, ` data_channel_is_entertainment`,
             ` data_channel_is_socmed`, ` data_channel_is_tech`,
             ` data_channel_is_world`, url, ` timedelta`))

# Remove space in front of each column name
names(onlineNewsLifestyle) <- sub(" ", "", names(onlineNewsLifestyle))

# All of the data that has been read in are categorical columns. Let's change this.
onlineNewsLifestyle <- lapply(onlineNewsLifestyle, as.numeric)
# Convert to dataframe for plotting
onlineNewsLifestyle <- data.frame(onlineNewsLifestyle)

# Summary statistics for shares
sum <- summary(onlineNewsLifestyle$shares)
std <- sd(onlineNewsLifestyle$shares)
median <- sum[3]

# Create Day variable to combine days for contingency table
dayShares <- onlineNewsLifestyle %>% 
  mutate(Day = if_else(weekday_is_monday == 1, "M",
                          if_else(weekday_is_tuesday == 1, "T",
                                  if_else(weekday_is_wednesday == 1, "W", 
                                          if_else(weekday_is_thursday == 1, "R",
                                                  if_else(weekday_is_friday == 1, "F",
                                          "Weekend"))))))

# Add Popular variable for rows where shares is greater than the median
dayShares <- dayShares %>% mutate(Popular = ifelse(shares > median, "Yes", "No")) %>% select(Popular, everything())

# Contingency table for day of the week and shares greater than the median
table(dayShares$Popular, factor(dayShares$Day, levels = c("M", "T", "W", 
                                                          "R", "F", "Weekend")))

# Scatterplot of Number of words in title vs. shares
ggplot(onlineNewsLifestyle, aes(n_tokens_title, shares)) +
  geom_point()

# Scatterplot of Number of words in content vs. shares
ggplot(onlineNewsLifestyle, aes(n_tokens_content, shares)) +
  geom_point()

# Histogram of total shares. Median line drawn in
ggplot(onlineNewsLifestyle, aes(x=shares))+
  geom_histogram(binwidth = 500, color="darkblue", fill="lightblue") +
  xlim(0,30000) +
  geom_vline(aes(xintercept = median), colour="black")
```

